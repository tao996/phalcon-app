const admin={config:{debug:false,url:{imageSave:"/api/m/tao/user.file/save",imageList:"/m/tao/user.file/index"},ajax:{headers:function(){if(!admin.util.isEmpty(window.CONFIG)&&!admin.util.isEmpty(window.CONFIG.CSRF_TOKEN)){return{"X-CSRF-TOKEN":window.CONFIG.CSRF_TOKEN}}return{}},refreshHeaders:function(method="get"){if(["post","put","delete"].includes(method)){console.log("try to refresh csrf-token")}}}},debug:function(){return admin.config.debug||false},assign:function(option){Object.assign(admin.config,option)},util:{isEmpty:function(data){if(data===null||data===undefined){return true}switch(typeof data){case"undefined":return true;case"number":return data===0;case"string":data=data.trim();return data==="0"||data==="null"||data===""||data==="undefined"||data==="0001-01-01T00:00:00Z"||data==="0001-01-01 00:00:00";case"object":const r=JSON.stringify(data);return r==="{}"||r==="[]";case"boolean":return!data;default:return!!data}},checkMobile:function(){return layui.device("mobile")},concatQuery:function(dict){var d=[];for(var key in dict){d.push(key+"="+dict[key])}return d.join("&")},appendOrReplaceQueryParam:function(url,name,value){const separator=url.includes("?")?"&":"?";const append=`${name}=${value}`;if(url.includes(name+"=")){const re=new RegExp(`${name}=\\d+`);return url.replace(re,append)}else{return url+separator+append}},layOn:function(binds){layui.util.on("lay-on",binds)},pick:function(obj,...props){return Object.assign({},...props.map(prop=>({[prop]:obj[prop]})))},toDateString:function(phpTimestamp,format="yyyy-MM-dd"){if(phpTimestamp<1){return""}return layui.util.toDateString(phpTimestamp*1e3,format)}},layer:{image:function(src,title="圖片展示"){layer.photos({photos:{title:title,start:0,data:[{src:src}]}})},success:function(msg,callback){return layui.layer.msg(msg,{icon:1,scrollbar:false,time:2e3,shadeClose:true},this._createCallback_(callback))},error:function(msg,callback){return layui.layer.msg(msg,{icon:2,scrollbar:false,time:3e3,shadeClose:true},this._createCallback_(callback))},alert:function(msg,callback,options={}){return layui.layer.alert(msg,Object.assign({scrollbar:false},options),function(index){layui.layer.close(index);if(typeof callback=="function"){callback()}})},confirm:function(msg,ok,no){return layui.layer.confirm(msg,{title:"操作确认",btn:["确认","取消"]},function(index){if(typeof ok==="function"){ok(index)}admin.layer.close(index)},function(index){if(typeof no==="function"){no(index)}admin.layer.close(index)})},tips:function(msg,time,callback){return layui.layer.msg(msg,{time:(time||3)*1e3,end:this._createCallback_(callback),shadeClose:true})},msg:function(message){return layui.layer.msg(message)},loading:function(msg="",callback=null){return msg?layui.layer.msg(msg,{icon:16,scrollbar:false,time:0,end:this._createCallback_(callback)}):layui.layer.load(2,{time:0,scrollbar:false,end:this._createCallback_(callback)})},load:function(seconds=2){const index=layer.load(2,{time:seconds*1e3});layer.close(index)},close:function(index=0){if(index===0){layui.layer.closeAll()}else{return layui.layer.close(index)}},_createCallback_:function(callback){if(typeof callback==="function"){return callback}else{return function(index){if(!admin.util.isEmpty(index)){this.close(index)}}}}},ajax:{_isPosting:false,get:function(option,ok,no,complete,ex){this.ajax("get",option,ok,no,complete,ex)},post:function(option,ok,no,complete,ex){this.ajax("post",option,ok,no,complete,ex)},postLimit:function(option,ok,no,complete,ex){if(this._isPosting){layui.layer.msg("操作过于频繁，请稍等一会");return}this._isPosting=true;this.ajax("post",option,ok,no,function(data){admin.ajax._isPosting=false;if(typeof complete=="function"){complete(data)}},function(obj){admin.ajax._isPosting=false;if(typeof ex==="function"){ex(obj)}})},ajax:function(type,option,ok,no,complete,ex){option=Object.assign({url:"",data:{},dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",timeout:6e4,statusName:"code",statusCode:0},option);if(option.url===""){option.url=this.apiURL()}const loadIndex=admin.layer.loading("加载中");layui.jquery.ajax({url:option.url,type:type||"get",data:option.data,dataType:option.dataType,contentType:option.contentType,timeout:option.timeout,headers:admin.config.ajax.headers(),success:function(res){if([0,200].includes(res[option.statusName])){if(typeof ok==="string"){admin.layer.success(ok)}else if(res.msg){admin.layer.success(res.msg)}if(typeof ok=="function"){setTimeout(function(){ok(res)},500)}}else{admin.layer.error(typeof no=="string"?no:res.msg);typeof no=="function"&&no(res)}},error:function(xhr,textstatus,thrown){admin.layer.error("Status:"+xhr.status+"，"+xhr.statusText+"，请稍后再试！",function(){if(typeof ex==="function"){ex(this)}})},complete:function(xhr){admin.layer.close(loadIndex);admin.config.ajax.refreshHeaders(option.type);try{const data=JSON.parse(xhr.responseText).data;if(typeof complete==="function"){complete(data)}}catch(e){console.error("响应结果不符合规范:",option.url)}}})},apiURL:function(){return location.origin+"/api"+location.pathname+location.search}},form:{onSubmit:function(layFilter,action){layui.form.on(`submit(${layFilter})`,function(data){const dataField=data.field;action(dataField);return false})},on:function(layFilterName,action,eleKind=""){const name=admin.util.isEmpty(eleKind)?layFilterName:`${eleKind}(${layFilterName})`;layui.form.on(name,function(data){try{action(data)}catch(e){console.error(e)}return false})},submitFirst:function(ok,postDataCallback,options={url:""}){const formList=document.querySelectorAll("[lay-submit]");if(formList.length>0){const f=layui.jquery(formList[0]);if(f.attr("data-type")==="tableSearch"){return false}let filter=f.attr("lay-filter");if(admin.util.isEmpty(filter)){filter="save_form_1";f.attr("lay-filter",filter)}layui.form.on("submit("+filter+")",function(data){let postData=data.field;if(typeof postDataCallback=="function"){try{postData=postDataCallback(postData)}catch(e){console.error(e);return false}}if(postData===false||null===postData){console.warn("取消了表单提交");return false}let url="";switch(typeof options.url){case"string":url=options.url;break;case"function":url=options.url();break}admin.form.request(url,postData,ok,options.no,options.complete,options.ex);return false})}},request:function(url,data,ok,no,complete,ex){if(url===undefined||url===""||url===null){url=location.origin+"/api"+location.pathname+location.search}admin.ajax.post({url:url,data:data},function(data){ok(data)},no,complete,ex)},updateValueByName:function(kvs){for(const name in kvs){document.getElementsByName(name)[0].value=kvs[name]}},patch:function(layFilterName,values){layui.form.val(layFilterName,values)},captcha:function(success){layer.open({type:1,area:"250px",resize:false,shadeClose:true,offset:Math.max((window.innerHeight-400)/2,100)+"px",title:"验证码",content:`<div class="layui-form" lay-filter="form-captcha" style="margin: 16px;">
<div>
<img src="/m/tao/captcha" onclick="this.src='/m/tao/captcha?t='+ new Date().getTime();" id="formCaptcha">
<div style="font-size: 0.9em;font-weight: bold" lay-on="refreshCaptcha">点击图片刷新验证码（不区分大小写）</div>
</div>
<div style="margin: 10px 0;">
 <input type="text" name="captcha" value="" lay-verify="required" 
 placeholder="请填写图片上的验证码" lay-reqtext="请填写验证码" maxlength="4"
 autocomplete="off" class="layui-input" lay-affix="clear">
</div>
<div class="layui-form-item">
    <button class="layui-btn layui-btn-fluid" lay-submit lay-filter="submit-captcha">确定</button>
</div>
</div>
`,success:function(layero,index){layui.form.render();layui.form.on("submit(submit-captcha)",function(data){const captcha=data.field.captcha;layer.close(index);success(captcha);return false});layui.util.on({refreshCaptcha:function(){document.getElementById("formCaptcha").src="/m/tao/captcha?t="+(new Date).getTime()}})}})},bindDate:function(){layui.laydate.render({elem:".bind_date"});layui.laydate.render({elem:".bind_datetime",type:"datetime"})}},page:{closeCurrentOpen:function(option){option=Object.assign({refreshTable:false,refreshFrame:false},option||{});const parentIndex=parent.layer.getFrameIndex(window.name);parent.layer.close(parentIndex);if(option.refreshTable){parent.layui.table.reload()}if(option.refreshFrame){parent.location.reload()}return true},inIframe:function(){try{return window.self!==window.top}catch(e){return true}},open:function(title,url,end){admin.iframe.open(url,{title:title,end:end})}},iframe:{open:function(url,options={}){if(admin.util.isEmpty(options.width)&&admin.util.isEmpty(options.height)){const width=window.innerWidth,height=window.innerHeight;if(width>=1e3&&height>=600){options.width="1000px";options.height="600px"}else{options.width="100%";options.height="100%"}}if(options.full===true){options.width="100%";options.height="100%"}let iFrameIndex=layui.layer.open({title:options.title||"",type:2,area:[options.width,options.height],content:url,shadeClose:true,maxmin:true,end:function(){if(typeof options.end==="function"){options.end(iFrameIndex);iFrameIndex=null}}});if(options.resize){$(window).on("resize",function(){index&&layer.full(iFrameIndex)})}},closeFromParent:function(refresh=false){const index=parent.layer.getFrameIndex(window.name);parent.layer.close(index);if(refresh){localStorage.setItem("tao.refresh","yes")}},hasRefresh:function(action){if(localStorage.getItem("tao.refresh")==="yes"){if(typeof action==="function"){action()}localStorage.removeItem("tao.refresh")}},updateParentMenu:function(){try{parent.notifyUpdateMenu()}catch(err){console.log("parent iframe not find, update menu failed")}},addParentTab:function(title,href,id=0){try{parent.appendTab(title,href,id)}catch(err){location.href=href}}},upload:{after:function(url,name){console.log("todo upload.after:",url,name)},remove:function(url){},run:function(){const uploadList=document.querySelectorAll("[data-upload]");const uploadSelectList=document.querySelectorAll("[data-upload-select]");if(uploadList.length>0){layui.jquery.each(uploadList,function(i,v){const jThis=$(this);const uploadExts=jThis.attr("data-upload-exts")||"png|jpg|jpeg",uploadName=jThis.attr("data-upload"),uploadNumber=jThis.attr("data-upload-number")||"one",uploadSeparator=jThis.attr("data-upload-separator")||"|",uploadAccept=jThis.attr("data-upload-accept")||"file",uploadAcceptMime=jThis.attr("data-upload-mimetype")||"";const elem="input[name='"+uploadName+"']",multiple=uploadNumber!=="one",uploadElem=this;const headers=admin.config.ajax.headers();layui.upload.render({elem:this,url:admin.config.url.imageSave,exts:uploadExts,accept:uploadAccept,acceptMime:uploadAcceptMime,multiple:multiple,headers:headers,before:function(obj){layui.layer.load()},done:function(res){layui.layer.closeAll();if(res.code===0){let url=res.data.url;if(multiple){var oldUrl=$(elem).val();if(oldUrl!==""){url=oldUrl+uploadSeparator+url}}$(elem).val(url);$(elem).trigger("input");layui.layer.msg("上传成功",{icon:1,time:2e3});admin.upload.after(url,"upload")}},error:function(){setTimeout(function(){layui.layer.closeAll()},3e3)},complete:function(){admin.config.ajax.refreshHeaders("post")}});$(elem).bind("blur",function(){admin.upload.after($(this).val(),"blur")});$(elem).bind("input propertychange",function(event){const urlString=$(this).val(),urlArray=urlString.split(uploadSeparator),uploadIcon=$(uploadElem).attr("data-upload-icon")||"file";$("#bing-"+uploadName).remove();if(urlString.length>0){const parant=$(this).parent("div");let liHtml="";$.each(urlArray,function(i,v){liHtml+=`<li>
<a><img src="${v}"></a>
<small class="uploads-delete-tip bg-red badge" data-upload-delete="${uploadName}" data-upload-url="${v}" data-upload-separator="${uploadSeparator}">×</small>
</li>`});parant.after('<ul id="bing-'+uploadName+'" class="layui-input-block layuimini-upload-show">\n'+liHtml+"</ul>")}});if($(elem).val()!==""){$(elem).trigger("input")}});layui.jquery("body").on("click","[data-upload-delete]",function(){const uploadName=$(this).attr("data-upload-delete"),deleteUrl=$(this).attr("data-upload-url"),sign=$(this).attr("data-upload-sign");layui.layer.confirm("确定要删除吗？",function(index){const elem="input[name='"+uploadName+"']";const currentUrl=$(elem).val();let url="";if(currentUrl!==deleteUrl){url=currentUrl.search(deleteUrl)===0?currentUrl.replace(deleteUrl+sign,""):currentUrl.replace(sign+deleteUrl,"");$(elem).val(url);$(elem).trigger("input")}else{$(elem).val(url);$("#bing-"+uploadName).remove()}layui.layer.close(index);admin.upload.remove(url)});return false})}if(uploadSelectList.length>0){layui.jquery.each(uploadSelectList,function(i,v){const uploadName=$(this).attr("data-upload-select"),uploadNumber=$(this).attr("data-upload-number")||"one",uploadSeparator=$(this).attr("data-upload-separator")||"|";const selectCheck=uploadNumber==="one"?"radio":"checkbox",inputElem=$("input[name='"+uploadName+"']"),uploadElem=$(this).attr("id");$("#"+uploadElem).off("click").on("click",function(){admin.iframe.open(admin.config.url.imageList+"?type="+selectCheck,{title:"图片选择",end:function(){admin.storage.getArray("images",images=>{const url=images.join(uploadSeparator);inputElem.val(url);inputElem.trigger("input");admin.layer.success("选择成功");admin.upload.after(url,"picker")})}})})});layui.jquery(".data-upload-img-edit").bind("click",function(){const name=this.getAttribute("data-name");const inputEle=$("input[name="+name+"]");layer.prompt({formType:0,value:inputEle.val(),title:"请输入图片地址"},function(value,index,elem){inputEle.val(value);inputEle.trigger("input");admin.upload.after(value,"edit");layer.close(index)})})}return this}},table:{_config:{id:"table",url:"",autoApi:true,tableId:null,key:"id",rowAction:function(){}},getConfig:function(config,key,defV=null){if(!admin.util.isEmpty(config)&&!admin.util.isEmpty(config[key])){return config[key]}return this._config[key]||defV},with:function(config={}){Object.assign(this._config,{url:admin.ajax.apiURL()},config);return this},getTableId:function(){return this._config.tableId},reloadData:function(){this._config.tableId.reloadData()},reloadWhenIframeRefresh:function(){admin.iframe.hasRefresh(()=>{admin.table.reloadData()})},render:function(options,additions={}){const tableId=this._config.id;const config=Object.assign({elem:"#"+tableId,url:this._config.url||admin.ajax.apiURL(),defaultToolbar:["filter",{title:"搜索",layEvent:"search",icon:"layui-icon-search"}],page:true},options);if(config.page&&admin.util.isEmpty(config["limit"])){config["limit"]=15;config["limits"]=[1,15,30,50]}const adds=Object.assign({search:true},additions);const currentTable=layui.table.render(config);const tableSearchElem=$("#"+tableId+"-search");if(adds.search){if(tableSearchElem.length===1){const resetElem=tableSearchElem.find("button[type=reset]");if(resetElem.length===1){resetElem.bind("click",function(){currentTable.reloadData({where:{reset:1},page:{curr:1}})})}else{console.log('没有找到重置按钮 <button type="reset" class="layui-btn layui-btn-primary">重置</button>')}const submitElem=tableSearchElem.find("a[lay-submit]");if(submitElem.length===1){submitElem.bind("click",function(e){e.stopPropagation();e.preventDefault();const data=form.val("form-search");currentTable.reloadData({where:data,page:{curr:1}})})}else{console.log('没有找到提交按钮 <a class="layui-btn layui-btn-normal" lay-submit>搜索</a>')}table.on("toolbar("+tableId+")",function(obj){switch(obj.event){case"search":if(tableSearchElem.hasClass("layui-hide")){tableSearchElem.removeClass("layui-hide")}else{tableSearchElem.addClass("layui-hide")}break}})}else{console.log('开启了条件搜索，但没有找到 <fieldset id="'+tableId+'-search">')}}layui.util.on("lay-on",{refresh:function(){currentTable.reloadData()}});this._config.tableId=currentTable;return this},addLayOnActions:function(config={}){const tableId=this._config.id;const url=config&&config.url?config.url:this._config.url;layui.util.on("lay-on",{batchDelete:function(){const rows=table.checkStatus(tableId);if(rows.data.length<1){admin.layer.error("没有选中任何记录!")}else{const ids=rows.data.map(r=>r.id);admin.layer.confirm("确定要删除这些记录吗？",function(){admin.ajax.postLimit({url:"/api"+url+"/delete",data:{id:ids.join(",")}},function(){layui.table.reload(tableId);admin.table._config.rowAction("batchDelete",ids.join(","))})})}},create:function(){admin.iframe.open(url+"/add",{title:"添加记录",full:!$(this).attr("data-auto"),end:function(){admin.iframe.hasRefresh(()=>{layui.table.reload(tableId);admin.table._config.rowAction("add")})}})}});return this},events:function(action){const tableId=this._config.id;layui.table.on("tool("+tableId+")",function(obj){action(obj.event,obj.data)})},addLayEventActions:function(config={}){const tableId=this._config.id;const url=this.getConfig(config,"url");const key=this.getConfig(config,"key","id");layui.table.on("tool("+tableId+")",function(obj){const keyV=obj.data[key];switch(obj.event){case"edit":if(admin.table._config.rowAction("edit",obj.data)===false){return}admin.iframe.open(url+"/edit?"+key+"="+keyV,{full:true,title:"编辑记录",end:function(){admin.iframe.hasRefresh(()=>{layui.table.reloadData(tableId)})}});return;case"delete":case"remove":if(admin.table._config.rowAction("delete",obj.data)===false){return}admin.layer.confirm("确定要删除当前记录吗！",function(){admin.ajax.postLimit({url:"/api"+url+"/delete",data:{[key]:keyV}},function(){admin.table.removeWith(s=>s[key]===keyV)})});return;default:if(typeof config["events"]==="function"){config.events(obj)}else{console.warn("没有添加事件处理函数:",obj.event)}}});return this},icon:function(data){const v=data[this.field];return`<i class="${v}"></i>`},image:function(data,useV=false){const option={imageWidth:this.imageWidth||200,imageHeight:this.imageHeight||40,imageSplit:this.imageSplit||"|",imageJoin:this.imageJoin||"<br>",title:this.title||this.field,field:this.field,value:useV===true?data:data[this.field]};if(option.value===undefined||option.value===null){return'<img style="max-width: '+option.imageWidth+"px; max-height: "+option.imageHeight+'px;" src="'+option.value+'" data-image="'+option.title+'">'}else{const values=option.value.split(option.imageSplit),valuesHtml=[];values.forEach((value,index)=>{valuesHtml.push("<img onclick=\"admin.layer.image('"+value+'\')" style="max-width: '+option.imageWidth+"px; max-height: "+option.imageHeight+'px;" src="'+value+'">')});return valuesHtml.join(option.imageJoin)}},switch:function(data){const option={field:this.field,value:data[this.field],selectList:this.selectList||{0:"禁用",1:"启用"},tips:this.tips||"开|关",filter:this.filter||this.field};const key=admin.table._config.key;if(admin.util.isEmpty(data[key])){return""}const checked=[1,"1"].includes(option.value)?"checked":"";return`<input type="checkbox" name="${option.field}" value="${data[key]}"
lay-skin="switch" lay-text="${option.tips}" lay-filter="${option.filter}" ${checked}>`},humanTime:function(data,useV=false){const v=useV===true?data:data[this.field];if(admin.util.isEmpty(v)){return""}const date=new Date(v*1e3);return[date.getFullYear(),(""+(date.getMonth()+1)).padStart(2,"0"),(""+date.getDate()).padStart(2,"0")].join("-")+" "+[(""+date.getHours()).padStart(2,"0"),(""+date.getMinutes()).padStart(2,"0"),(""+date.getSeconds()).padStart(2,"0")].join(":")},humanDate:function(data,useV=false){const v=useV===true?data:data[this.field];if(admin.util.isEmpty(v)){return""}const date=new Date(v*1e3);return[date.getFullYear(),(""+(date.getMonth()+1)).padStart(2,"0"),(""+date.getDate()).padStart(2,"0")].join("-")},objPath:function(data){const keys=this.field.split(".");let currentObj=data;for(let i=0;i<keys.length;i++){if(currentObj.hasOwnProperty(keys[i])){currentObj=currentObj[keys[i]]}else{currentObj=null;break}}return`<div>${currentObj}</div>`},listenSwitch:function(field,action){layui.form.on("switch("+field+")",function(data){const elem=data.elem;const othis=data.othis;action({value:elem.value,checked:elem.checked,obj:othis})})},addPostSwitch:function(fields=["status"],config={}){const url=this.getConfig(config,"url");const key=this.getConfig(config,"key","id");fields.forEach(field=>{if(admin.util.isEmpty(field)){console.warn("listenSwitch empty field");return}admin.table.listenSwitch(field,function(data){const postData={[key]:data.value,field:field,value:data.checked?1:2};admin.ajax.post({url:url+"/modify",data:postData},function(){admin.table._config.rowAction("modify",postData)})})});return this},listenEditText:function(tableId,callback){table.on("edit("+tableId+")",callback)},addPostEditText:function(config){const tableId=this._config.id;const url=config&&config.url?config.url:this._config.url;admin.table.listenEditText(tableId,function(obj){const postData={id:obj.data.id,field:obj.field,value:obj.value};admin.ajax.post({url:url+"/modify",data:postData},function(){if(config&&typeof config.ok==="function"){config.ok(postData)}admin.table._config.rowAction("modify",postData)})});return this},removeWith:function(predicate){const tableId=this._config.id;const rows=layui.table.cache[tableId];const index=rows.findIndex(predicate);if(index>-1){rows.splice(index,1);layui.table.renderData(tableId)}else{admin.layer.error("没有找到需要删除的数据项")}return this}},date:{renderDate:function(id,range=true){layui.laydate.render({elem:"#"+id,type:"date",range:range})},renderDatetime:function(id){layui.laydate.render({elem:"#"+id,type:"datetime"})}},storage:{read:function(name){return localStorage.getItem(name)},save:function(name,data){localStorage.setItem(name,typeof data==="object"?JSON.stringify(data):data)},getArray:function(name,success,remove=true){const data=localStorage.getItem(name);if(remove){localStorage.removeItem(name)}if(data&&data.length>0){const rows=JSON.parse(data);if(rows&&rows.length>0){success(rows)}}},getFirst:function(name,success,remove=true){this.getArray(name,rows=>{success(rows[0])},remove)},getParse:function(name,success,remove=true){const data=localStorage.getItem(name);if(remove){localStorage.removeItem(name)}const rst=data&&data.length>0?JSON.parse(data):null;if(rst){success(rst)}}},cache:{table:"phax",read:function(key,defV){const local=layui.data(this.table);const v=local[key];if(admin.util.isEmpty(v)){return defV}return JSON.parse(v)},save:function(key,data){layui.data(this.table,{key:key,value:JSON.stringify(data)})},remove:function(key){layui.data(this.table,{key:key,remove:true})},clear:function(){localStorage.clear()}},pagination:{_cache:{},with:function(name,options={}){const tplName=options.tpl||name+"Tpl";const tplElem=document.getElementById(tplName);if(tplElem==null){console.warn("could not find tpl for pagination:",tplName);return false}const viewName=options.view||name+"View";const viewElem=document.getElementById(viewName);if(viewElem==null){console.warn("could not find view for pagination:",viewName);return false}this._cache[name]=Object.assign({id:"pag",count:0,curr:1,rows:[],hasLoad:false,groups:options.groups||1,tplElem:layui.laytpl(tplElem.innerHTML),viewElem:viewElem},options);return true},getOption:function(name){if(admin.util.isEmpty(this._cache[name])){throw new Error("pagination option not find:"+name)}return this._cache[name]},request:function(name){const cd=this.getOption(name);admin.ajax.get({url:cd.url},res=>{cd.hasLoad=true;cd.count=res.count;cd.rows=res.data;this.render(name)})},render:function(name){const cd=this.getOption(name);layui.laypage.render({elem:cd.id,count:cd.count,curr:cd.curr,groups:cd.groups,first:false,last:false,limit:15,layout:cd.layout||["prev","page","next","count"],jump:function(obj,firstRun){if(firstRun){}else{cd.url=admin.util.appendOrReplaceQueryParam(cd.url,"page",obj.curr);cd.url=admin.util.appendOrReplaceQueryParam(cd.url,"limit",obj.limit);admin.ajax.get({url:cd.url},res=>{cd.count=res.count;cd.rows=res.data})}cd.tplElem.render(cd,function(content){cd.viewElem.innerHTML=content})}})}}};